<template name="project">
  {{#if project}}
  {{#with project}}
  {{#if loading}}
  <div style="margin-top: 100px" class="row-fluid">
    <div class="span12">
      {{> spinner}}
    </div>
  </div>
  {{else}}
  <p>
    <span class="large-font"><a href="/project/{{_id}}">{{project_name}}</a></span>
        <span class="pull-right">
          <a class="btn btn-primary" href="/project/{{_id}}"><i class="icon-dashboard"> </i>Load</a>
          <a href="#exportModal" role="button" class="btn btn-success" data-toggle="modal"><i class="icon-share-alt"> </i>Export</a>
          {{#if isOwner}}
            <a href="#removeProjectModal" role="button" data-toggle="modal"><button class="btn btn-danger"><i class="icon-trash"> </i>Delete</button></a>
          {{else}}
            <button class="btn btn-warning" id="leave-project"><i class="icon-external-link"> </i>Leave</button>
          {{/if}}
        </span>
  </p>
  <div class="row-fluid">
    <div class="span12">
      <ul class="unstyled">
        <li><strong>Created on: </strong>{{creation_date}}</li>
        <li><strong>Owner: </strong>{{owner}}</li>
        <li><strong>Contributors: </strong>{{#if contributors}}{{#each contributors}}{{emails.0.address}} {{/each}}{{else}}None{{/if}}</li>
        <li><strong>Industry: </strong>{{#if industry}}{{industry}}{{else}}None{{/if}}</li>
        <li><p><strong>Description: </strong>{{#if description}}{{description}}{{else}}None{{/if}}</p></li>
      </ul>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span4">
      <h5>Hosts</h5>
      <canvas id="hostChart" width="{{width}}" height="{{height}}"></canvas><br />
    </div>
    <div class="span4">
      <h5>Services</h5>
      <canvas id="serviceChart" width="{{width}}" height="{{height}}"></canvas><br />
    </div>
    <div class="span4">
      <h5>Vulnerabilities</h5>
      <canvas id="vulnerabilityChart" width="{{width}}" height="{{height}}"></canvas><br />
    </div>
  </div>
  {{/if}}
  {{/with}}
  {{else}}
  <div class="row-fluid">
    <div class="span12">
      <p class="large-font">You don't have any projects</p>
    </div>
  </div>
  {{/if}}
  <div id="exportModal" class="modal hide fade">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3>Export</h3>
    </div>
    <div class="modal-body">
      <div id="export-message"></div>
      {{> alerts}}
      <p>Place a URL for an http(s) listener. The project will be exported as JSON and sent to the server.</p>
      <br />
      <form style="text-align: center">
        <input type="text" class="span7" name="url" placeholder="HTTP(s) listener *Required"/><br />
        <input type="text" class="span7" name="username" placeholder="Username"/><br />
        <input type="password" class="span7" name="password" placeholder="Password" />
      </form>
    </div>
    <div class="modal-footer">
      <button id="export-project" class="btn btn-success">Export</button>
    </div>
  </div>

  <div id="removeProjectModal" class="modal hide fade">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3>Confirm project deletion</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to remove this project? Removing this project will permanently delete all associated data. This can't be undone.</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-danger" id="remove-project" data-dismiss="modal">Confirm</button>
      <button class="btn" data-dismiss="modal">Cancel</button>
    </div>
  </div>

</template>
